---

- name: Update yum cache
  yum:
    update_cache: yes

- name: Install required packages
  yum:
    name: "{{ packages }}"
    state: present
  vars:
    packages:
      - virtualbox
      - virtualbox-ext-pack
      - vagrant
      - ansible
      - packer

- name: Start and enable the VirtualBox service
  service:
    name: vboxdrv
    state: started
    enabled: yes

- name: Add user to vboxusers group 
  user:
    name: "{{ ansible_user }}"
    groups: vboxusers
    append: yes
